\documentclass[runningheads]{llncs}
\usepackage[T1]{fontenc}
\usepackage{attachfile}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{hyperref}
\usepackage{enumitem}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}  % Defines a new command for the horizontal lines, change thickness here
\newcommand{\SubSec}[1]{\vspace{1em}\noindent\textsc{\textbf{#1}}\vspace{0.5em} \\} % Custom command to mimic subsections

\begin{document}

\title{Group Project: Deep Learning for a Smart Fridge}
\author{Jacob Saunders\inst{1}\orcidID{0000-0000-0000-0000}}
\authorrunning{J. Saunders}

\institute{College of Engineering, Science and Environment\\ School of Information and Physical Sciences\\ The University of Newcastle\\ Student ID: c3262240\\
\email{c3262240@uon.edu.au}}

\maketitle

\section*{Description}

\noindent Student groups work to ﬁnd solutions to deep learning tasks by using Python, PyTorch, and other relevant Python packages. The submission includes:

\begin{enumerate}
    \item A group report that addresses the questions speciﬁed in this document with written text, ﬁgures, and tables. The report is to be formatted in Springer LNCS format and exported to pdf format. The LNCS conference paper template is available at the following link: \url{https://www.springer.com/gp/computer-science/lncs/conference-proceedings-guidelines}. The report length in pages should fall in the given range. To save space, ﬁgures and/or tables can be placed into an Appendix.
    \item A trained PyTorch model for image classification (see Question 1 b)
    \item A Python inference script (see Question 1 b)
    \item (If necessary) a README ﬁle explaining how to use your inference script
    \item (If necessary) a requirements.txt ﬁle specifying packages required to run your inference script
    \item A document that states the contributions of each group member. If the contributions within the group are very diﬀerent and/or a conﬂict arises, the marks will be weighted according to this document. Please start conducting peer assessments early in the project in case any group management issues may arise and request guidance by your lab tutor.
    \item All Python code used to produce the results discussed in the report as Supplemental Material. Marks may be deducted for results in the report that cannot be reproduced from submitted code (allowing for variation due to random model initialisation etc.).
\end{enumerate}

\noindent It is suﬃcient if one group member submits. Make sure that all other group member names are listed and each member has signed (!) the agreed group report with individual member contribution statements. \\

\noindent The following pages contain the questions to be addressed in the report, and the marking criteria.

\newpage

\section*{Question 1: Image Classification for a Smart Fridge (COMP3330 and COMP6380)}

\noindent Samsung’s smart fridge range uses AI vision and an internal camera. The system can identify up to 33 fresh food items when put in or taken out of the fridge: \\

\url{https://www.samsung.com/au/refrigerators/family-hub/} \\

\noindent Your task is to develop a computer vision classifier as part of a new more capable smart fridge system that can identify up to 40 fresh food items. 144 example images that are similar to the secret testimages used for final evaluation of your model are provided in the data set FoodTest1.zip \\
\begin{enumerate}
    \item Develop deep learning models to classify images into the 40 given food item classes that are contained in the provided image data set FoodTest1.zip. Experiment with different approaches and models including models that are trained bottom up and others that are obtained using transfer learning. Run experiments with the goal to identify ways to achieve high validation accuracies (e.g., model choice, hyperparameter choice, regularisation, etc.). Determine which model is best suited for a smart fridge taking performance, computing requirements and power consumption into account. For example, a very large model may require a large computer or internet access and would increase production and running costs. The supporting discussion should be documented in your group report, including figures and tables comparing different candidate models, their advantages and disadvantages and the performances that you can achieve.
    \item Save your most recommended two models for submission and prepare an inference script. It will need to:
    \begin{enumerate}
        \item Load your submitted best models
        \item Load images from a folder of *.jpg files
        \item Export the model predictions for all images as a ﬁle preds.csv (ﬁrst column: image ﬁlename, second column: predicted class between 0 and 39)
    \end{enumerate}
\end{enumerate}

\noindent We will evaluate your model based on a secret test set. It is similar to and of the same size as your validation set FoodTest1.zip and comprises new unseen images of the same 40 categories of food items. The achieved top-1 accuracies of your two models on the secret test set will contribute to your team's mark. \\
\noindent \underline{Note:} FoodTest1.zip is available on Canvas so you can use it to train and test your inference script. You can either assume that both your script and model file will be placed in the test folder before we run it, or include a README file that explains how to use your inference script. \\
\noindent \underline{Important:} If your inference script requires specific packages and/or versions of packages, include a requirements.txt file specifying these. \\

\SubSec{Question 1 Response:}

\noindent\textbf{Data Collection and Model Choice:} \\
The project began with an exploration into pre-trained models, fueled by the initial excitement of discovering a model based on the well-regarded Foods 101 dataset, which boasts hundreds of thousands of high-quality images. However, this enthusiasm quickly waned after the model was tested on the dataset provided for the assignment and yielded poor accuracy, ranging between 3 to 6 percent. Further investigation revealed a critical mismatch: the Foods 101 dataset primarily features images depicting dishes, not individual food ingredients. This key insight led to a decisive pivot away from using the pre-existing Foods 101 dataset. In response, a tailored dataset was meticulously compiled, emphasizing the importance of image relevance and data quality. This new dataset was designed to reflect the actual contents typically found in a fridge, ensuring the model’s utility in realistic scenarios.

\noindent\textbf{Handling Data Imbalance:} \\
A significant challenge addressed was the imbalance in class distribution—initially, some classes like chicken were overrepresented compared to others like pork. This imbalance skewed the model's ability to generalize, often misclassifying less represented classes. To counteract this, the dataset was normalized by reducing the overrepresented class samples, thereby enhancing the model's accuracy and generalization capabilities across diverse food items.

\noindent\textbf{Model Training and Validation:} \\
The model training employed a K-fold cross-validation approach to maximize the utility of the available data. However, due to limited data and time constraints, the model was retrained sequentially and accumulatively across each fold. This approach might have led to potential self-contamination issues. Despite this, the strategy was deemed necessary given the aforementioned constraints. Early stopping was implemented during training to prevent overfitting, further attempting to ensure the robustness of the model under the given conditions.

\noindent\textbf{Model Performance and Inference:} \\
Upon final training, the model demonstrated promising performance in classifying a wide range of food items directly from images. An inference script was successfully developed to process unsorted images and predict their classes, outputting results in a user-friendly CSV format that includes both predicted classes and their corresponding human-readable names. This functionality underscores the model's practicality for integration into smart fridge systems, offering a real-time, automated method for inventory management based on visual data.

\noindent\textbf{Conclusions and Future Directions:} \\
While the model achieved functional performance, the limitations posed by data availability and potential validation compromises were acknowledged. Future work could explore more sophisticated data augmentation techniques, acquire a more balanced and comprehensive dataset, and employ a more stringent cross-validation strategy to further refine the model's accuracy and reliability. The current work lays a foundational step towards realizing an AI-enhanced smart fridge, with improvements poised to enhance its viability for commercial applications.

\section*{Question 2: Smart Fridge System Design (COMP6380 only)}

\noindent Based on the deep learning study in question 1, propose and discuss a possible design of the AI system for a new smart fridge and take two cases into account:
\begin{enumerate}
    \item A fridge system that can connect to the internet.
    \item A smart fridge system that operates in areas without any internet connection or any external communications.
\end{enumerate}

\noindent Provide a literature review and compare and discuss the two use cases.

\SubSec{Question 2 Response:}

\noindent\textbf{Online Smart Fridge System (Centralised):} \\
A practical approach to implementing a smart fridge system with an internet connection is to utilize a centralized model. In this model, the fridge is equipped primarily with camera hardware, while the computational heavy lifting, such as image processing and decision-making, is offloaded to a remote server. This structure leverages the server's robust computational resources, allowing for a more powerful and sophisticated AI model than would be feasible within the fridge itself.

The primary advantage of this centralized approach is cost-efficiency; by reducing the computational hardware in each fridge, manufacturers can significantly lower production costs. Additionally, this model enhances scalability, allowing updates and improvements to be rolled out simultaneously to all connected fridges through server-side upgrades.

However, this system is not without its challenges. High bandwidth requirements for transmitting images and data to the server could be prohibitive, especially in regions with limited internet service. Privacy concerns are also significant, as sensitive personal data is handled and stored remotely.

Furthermore, the flexibility of server-based processing supports various fridge designs and configurations, enabling customization and adaptation to different kitchen layouts and user preferences. This system could potentially outperform existing models like those offered by Samsung, particularly in adaptability to new types of packaging or storage methods introduced in the market.

As we proceed, we will explore an alternative design for fridges operating in environments without internet connectivity. \\

\noindent\textbf{Online Smart Fridge System (De-Centralised):} \\
Additionally, another viable model for online smart fridges involves a mesh network approach, akin to the distributed nature of blockchain technology. In this model, fridges are interconnected within a peer-to-peer network, allowing them to share and process data collaboratively. This setup localizes data processing to the specific demographic of the region, potentially enhancing the accuracy of the AI system by tailoring it to the localized buying habits and preferences.

The mesh network model addresses some privacy concerns by keeping the data decentralized, thus avoiding the need to send sensitive information to a central server. It also distributes the computational load across multiple devices, which could lower bandwidth costs typically associated with sending data to a central location. However, this advantage comes at the cost of increased hardware requirements for each fridge within the network, potentially leading to higher energy consumption.

Despite these trade-offs, the decentralized nature of the mesh network model presents a significant benefit in terms of privacy. It ensures that data is processed and stored locally within the community, reducing the risk of external breaches and unauthorized access. This approach could provide a more secure and efficient method of data handling for smart fridges, aligning closely with the needs and expectations of privacy-conscious consumers. \\

\noindent\textbf{Offline Smart Fridge System: Retrained and Static Model} \\
The offline smart fridge model incorporates advanced data management features to enhance efficiency and ensure seamless operation. The model is designed to save its training progress frequently at different stages to minimize data loss during switching between training and inference modes. Specifically, the model saves the complete state during validation checkpoints and local tensors after each batch. This stratified saving approach allows the model to quickly revert to inference mode when needed, without significant loss of training progress.

Moreover, the model implements an early stopping mechanism, which halts training once it achieves the predefined accuracy levels or if it stops showing improvement over time. This feature is crucial for conserving energy and computational resources, as it prevents unnecessary computations once optimal performance is reached. 

The smart scheduling of training sessions also plays a pivotal role in optimizing the model's operation. Training primarily occurs during periods of low fridge usage, such as overnight, reducing energy consumption and avoiding conflicts with peak usage times when inference responsiveness is most critical.

This model's intelligent resource management not only ensures high reactivity and availability for inference tasks but also maximizes energy efficiency and hardware utilization. Training resumes only when a drop in accuracy is detected, indicating new user behaviors or the introduction of new items into the fridge. This dynamic adaptation helps maintain the model's accuracy over time without constant computation, aligning closely with the eco-friendly and cost-effective goals of modern smart home appliances.

% References
\bibliographystyle{splncs04}
\bibliography{assets/_biblo.bib}

\end{document}
